{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/lib/pages.ts"],"sourcesContent":["export interface Page {\n  id: string;\n  title: string;\n  slug: string;\n  parentId: string | null;\n  order: number;\n  summary?: string;\n  contentType: 'markdown';\n  content: string;\n  figmaEmbedUrl?: string;\n  codeSnippets?: {\n    react?: string;\n    tailwind?: string;\n    tokensJson?: string;\n  };\n  tags?: string[];\n  status: 'Draft' | 'Published' | 'Archived';\n  version?: string;\n  lastUpdated: string;\n  children?: Page[];\n}\n\nexport function generateSlug(title: string): string {\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-|-$/g, '');\n}\n\nexport function buildBreadcrumbs(pages: Page[], currentPageId: string): Array<{ title: string; href: string }> {\n  const breadcrumbs: Array<{ title: string; href: string }> = [];\n  let currentPage = pages.find(p => p.id === currentPageId);\n  \n  while (currentPage) {\n    breadcrumbs.unshift({\n      title: currentPage.title,\n      href: `/${currentPage.slug}`\n    });\n    \n    const parentId = currentPage.parentId;\n    if (parentId) {\n      const parentPage = pages.find(p => p.id === parentId);\n      if (!parentPage) break;\n      currentPage = parentPage;\n    } else {\n      break;\n    }\n  }\n  \n  return breadcrumbs;\n}\n\nexport function buildPageTree(pages: Page[]): Page[] {\n  const pageMap = new Map(pages.map(page => [page.id, { ...page, children: [] as Page[] }]));\n  const tree: Page[] = [];\n  \n  pages.forEach(page => {\n    if (page.parentId) {\n      const parent = pageMap.get(page.parentId);\n      const currentPage = pageMap.get(page.id);\n      if (parent && currentPage) {\n        parent.children = parent.children || [];\n        parent.children.push(currentPage);\n      }\n    } else {\n      const rootPage = pageMap.get(page.id);\n      if (rootPage) {\n        tree.push(rootPage);\n      }\n    }\n  });\n  \n  return tree;\n}"],"names":[],"mappings":";;;;;;;;AAsBO,SAAS,aAAa,KAAa;IACxC,OAAO,MACJ,WAAW,GACX,OAAO,CAAC,eAAe,KACvB,OAAO,CAAC,UAAU;AACvB;AAEO,SAAS,iBAAiB,KAAa,EAAE,aAAqB;IACnE,MAAM,cAAsD,EAAE;IAC9D,IAAI,cAAc,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IAE3C,MAAO,YAAa;QAClB,YAAY,OAAO,CAAC;YAClB,OAAO,YAAY,KAAK;YACxB,MAAM,CAAC,CAAC,EAAE,YAAY,IAAI,EAAE;QAC9B;QAEA,MAAM,WAAW,YAAY,QAAQ;QACrC,IAAI,UAAU;YACZ,MAAM,aAAa,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;YAC5C,IAAI,CAAC,YAAY;YACjB,cAAc;QAChB,OAAO;YACL;QACF;IACF;IAEA,OAAO;AACT;AAEO,SAAS,cAAc,KAAa;IACzC,MAAM,UAAU,IAAI,IAAI,MAAM,GAAG,CAAC,CAAA,OAAQ;YAAC,KAAK,EAAE;YAAE;gBAAE,GAAG,IAAI;gBAAE,UAAU,EAAE;YAAW;SAAE;IACxF,MAAM,OAAe,EAAE;IAEvB,MAAM,OAAO,CAAC,CAAA;QACZ,IAAI,KAAK,QAAQ,EAAE;YACjB,MAAM,SAAS,QAAQ,GAAG,CAAC,KAAK,QAAQ;YACxC,MAAM,cAAc,QAAQ,GAAG,CAAC,KAAK,EAAE;YACvC,IAAI,UAAU,aAAa;gBACzB,OAAO,QAAQ,GAAG,OAAO,QAAQ,IAAI,EAAE;gBACvC,OAAO,QAAQ,CAAC,IAAI,CAAC;YACvB;QACF,OAAO;YACL,MAAM,WAAW,QAAQ,GAAG,CAAC,KAAK,EAAE;YACpC,IAAI,UAAU;gBACZ,KAAK,IAAI,CAAC;YACZ;QACF;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/app/api/pages/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { promises as fs } from 'fs';\nimport path from 'path';\nimport { generateSlug } from '@/lib/pages';\nimport type { Page } from '@/lib/pages';\n\nconst pagesDir = path.join(process.cwd(), 'src/data/pages');\nconst redirectsPath = path.join(process.cwd(), 'src/data/redirects.json');\n\n// GET /api/pages - List all pages\nexport async function GET() {\n  const files = await fs.readdir(pagesDir);\n  const pages = await Promise.all(\n    files.map(async (file) => {\n      const content = await fs.readFile(path.join(pagesDir, file), 'utf8');\n      return JSON.parse(content);\n    })\n  );\n  \n  return NextResponse.json(pages);\n}\n\n// POST /api/pages - Create new page\nexport async function POST(request: Request) {\n  const data = await request.json();\n  const { title, parentId } = data;\n  \n  if (!title) {\n    return NextResponse.json(\n      { error: 'Title is required' },\n      { status: 400 }\n    );\n  }\n\n  const slug = generateSlug(title);\n  const id = parentId ? `${parentId}-${slug}` : slug;\n  \n  // Check for existing page with same slug under same parent\n  try {\n    await fs.access(path.join(pagesDir, `${id}.json`));\n    return NextResponse.json(\n      { error: 'Page with this slug already exists under the selected parent' },\n      { status: 409 }\n    );\n  } catch {\n    // File doesn't exist, we can proceed\n  }\n\n  const page: Page = {\n    id,\n    title,\n    slug,\n    parentId,\n    order: Date.now(), // Temporary order, should be managed properly\n    contentType: 'markdown',\n    content: '',\n    status: 'Draft',\n    lastUpdated: new Date().toISOString(),\n    ...data\n  };\n\n  await fs.writeFile(\n    path.join(pagesDir, `${id}.json`),\n    JSON.stringify(page, null, 2)\n  );\n\n  return NextResponse.json(page);\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAGA,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAC1C,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAGxC,eAAe;IACpB,MAAM,QAAQ,MAAM,yGAAE,CAAC,OAAO,CAAC;IAC/B,MAAM,QAAQ,MAAM,QAAQ,GAAG,CAC7B,MAAM,GAAG,CAAC,OAAO;QACf,MAAM,UAAU,MAAM,yGAAE,CAAC,QAAQ,CAAC,4GAAI,CAAC,IAAI,CAAC,UAAU,OAAO;QAC7D,OAAO,KAAK,KAAK,CAAC;IACpB;IAGF,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAGO,eAAe,KAAK,OAAgB;IACzC,MAAM,OAAO,MAAM,QAAQ,IAAI;IAC/B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;IAE5B,IAAI,CAAC,OAAO;QACV,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAoB,GAC7B;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,OAAO,IAAA,qIAAY,EAAC;IAC1B,MAAM,KAAK,WAAW,GAAG,SAAS,CAAC,EAAE,MAAM,GAAG;IAE9C,2DAA2D;IAC3D,IAAI;QACF,MAAM,yGAAE,CAAC,MAAM,CAAC,4GAAI,CAAC,IAAI,CAAC,UAAU,GAAG,GAAG,KAAK,CAAC;QAChD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+D,GACxE;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAM;IACN,qCAAqC;IACvC;IAEA,MAAM,OAAa;QACjB;QACA;QACA;QACA;QACA,OAAO,KAAK,GAAG;QACf,aAAa;QACb,SAAS;QACT,QAAQ;QACR,aAAa,IAAI,OAAO,WAAW;QACnC,GAAG,IAAI;IACT;IAEA,MAAM,yGAAE,CAAC,SAAS,CAChB,4GAAI,CAAC,IAAI,CAAC,UAAU,GAAG,GAAG,KAAK,CAAC,GAChC,KAAK,SAAS,CAAC,MAAM,MAAM;IAG7B,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B","debugId":null}}]
}