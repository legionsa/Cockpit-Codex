{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 12);\n}\n\nexport async function verifyPassword(password: string, hashedPassword: string): Promise<boolean> {\n  return bcrypt.compare(password, hashedPassword);\n}\n\nexport const securityQuestions = {\n  Q1: {\n    question: 'Who is the first PM of BookCabin?',\n    answer: 'Lita'\n  },\n  Q2: {\n    question: 'Who is the first Product Designer of BookCabin?',\n    answer: 'Ihsan Fauzan'\n  },\n  Q3: {\n    question: 'What is company\\'s car brand?',\n    answer: 'Hyundai'\n  }\n};\n\nexport function generatePassword(): string {\n  const length = 12;\n  const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*';\n  let password = '';\n  \n  // Ensure at least one of each required character type\n  const upper = charset.match(/[A-Z]/)?.at(0) ?? 'A';\n  const lower = charset.match(/[a-z]/)?.at(0) ?? 'a';\n  const number = charset.match(/[0-9]/)?.at(0) ?? '1';\n  const symbol = charset.match(/[!@#$%^&*]/)?.at(0) ?? '!';\n  \n  password += upper + lower + number + symbol;\n  \n  // Fill the rest randomly\n  for (let i = password.length; i < length; i++) {\n    password += charset.charAt(Math.floor(Math.random() * charset.length));\n  }\n  \n  // Shuffle the password\n  return password.split('').sort(() => Math.random() - 0.5).join('');\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,cAAsB;IAC3E,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,MAAM,oBAAoB;IAC/B,IAAI;QACF,UAAU;QACV,QAAQ;IACV;IACA,IAAI;QACF,UAAU;QACV,QAAQ;IACV;IACA,IAAI;QACF,UAAU;QACV,QAAQ;IACV;AACF;AAEO,SAAS;IACd,MAAM,SAAS;IACf,MAAM,UAAU;IAChB,IAAI,WAAW;IAEf,sDAAsD;IACtD,MAAM,QAAQ,QAAQ,KAAK,CAAC,UAAU,GAAG,MAAM;IAC/C,MAAM,QAAQ,QAAQ,KAAK,CAAC,UAAU,GAAG,MAAM;IAC/C,MAAM,SAAS,QAAQ,KAAK,CAAC,UAAU,GAAG,MAAM;IAChD,MAAM,SAAS,QAAQ,KAAK,CAAC,eAAe,GAAG,MAAM;IAErD,YAAY,QAAQ,QAAQ,SAAS;IAErC,yBAAyB;IACzB,IAAK,IAAI,IAAI,SAAS,MAAM,EAAE,IAAI,QAAQ,IAAK;QAC7C,YAAY,QAAQ,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ,MAAM;IACtE;IAEA,uBAAuB;IACvB,OAAO,SAAS,KAAK,CAAC,IAAI,IAAI,CAAC,IAAM,KAAK,MAAM,KAAK,KAAK,IAAI,CAAC;AACjE","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/data/users.json"],"sourcesContent":["{\"users\":[{\"id\":\"admin\",\"username\":\"binbin\",\"passwordHash\":\"$2b$12$M9onspqQXb9X331RyMMsBuWF//tQ0PznnIlhrdE1dVLebmxWz5tT.\"}]}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 104, "column": 150}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { verifyPassword } from '@/lib/auth';\nimport users from '@/data/users.json';\n\nexport async function POST(request: Request) {\n  const { username, password } = await request.json();\n\n  if (!username || !password) {\n    return NextResponse.json(\n      { error: 'Missing username or password' },\n      { status: 400 }\n    );\n  }\n\n  const user = users.users.find(u => u.username === username);\n  if (!user) {\n    return NextResponse.json(\n      { error: 'Invalid credentials' },\n      { status: 401 }\n    );\n  }\n\n  const isValid = await verifyPassword(password, user.passwordHash);\n  if (!isValid) {\n    return NextResponse.json(\n      { error: 'Invalid credentials' },\n      { status: 401 }\n    );\n  }\n\n  // Create session cookie here\n  const response = NextResponse.json(\n    { message: 'Logged in successfully' },\n    { status: 200 }\n  );\n\n  response.cookies.set({\n    name: 'session',\n    value: user.id,\n    httpOnly: true,\n    secure: true,\n    sameSite: 'lax',\n    path: '/'\n  });\n\n  return response;\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAgB;IACzC,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;IAEjD,IAAI,CAAC,YAAY,CAAC,UAAU;QAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+B,GACxC;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,OAAO,uGAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;IAClD,IAAI,CAAC,MAAM;QACT,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAsB,GAC/B;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,UAAU,MAAM,IAAA,sIAAc,EAAC,UAAU,KAAK,YAAY;IAChE,IAAI,CAAC,SAAS;QACZ,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAsB,GAC/B;YAAE,QAAQ;QAAI;IAElB;IAEA,6BAA6B;IAC7B,MAAM,WAAW,gJAAY,CAAC,IAAI,CAChC;QAAE,SAAS;IAAyB,GACpC;QAAE,QAAQ;IAAI;IAGhB,SAAS,OAAO,CAAC,GAAG,CAAC;QACnB,MAAM;QACN,OAAO,KAAK,EAAE;QACd,UAAU;QACV,QAAQ;QACR,UAAU;QACV,MAAM;IACR;IAEA,OAAO;AACT","debugId":null}}]
}