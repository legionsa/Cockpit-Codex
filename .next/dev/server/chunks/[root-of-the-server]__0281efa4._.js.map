{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 12);\n}\n\nexport async function verifyPassword(password: string, hashedPassword: string): Promise<boolean> {\n  return bcrypt.compare(password, hashedPassword);\n}\n\nexport const securityQuestions = {\n  Q1: {\n    question: 'Who is the first PM of BookCabin?',\n    answer: 'Lita'\n  },\n  Q2: {\n    question: 'Who is the first Product Designer of BookCabin?',\n    answer: 'Ihsan Fauzan'\n  },\n  Q3: {\n    question: 'What is company\\'s car brand?',\n    answer: 'Hyundai'\n  }\n};\n\nexport function generatePassword(): string {\n  const length = 12;\n  const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*';\n  let password = '';\n  \n  // Ensure at least one of each required character type\n  const upper = charset.match(/[A-Z]/)?.at(0) ?? 'A';\n  const lower = charset.match(/[a-z]/)?.at(0) ?? 'a';\n  const number = charset.match(/[0-9]/)?.at(0) ?? '1';\n  const symbol = charset.match(/[!@#$%^&*]/)?.at(0) ?? '!';\n  \n  password += upper + lower + number + symbol;\n  \n  // Fill the rest randomly\n  for (let i = password.length; i < length; i++) {\n    password += charset.charAt(Math.floor(Math.random() * charset.length));\n  }\n  \n  // Shuffle the password\n  return password.split('').sort(() => Math.random() - 0.5).join('');\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,cAAsB;IAC3E,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,MAAM,oBAAoB;IAC/B,IAAI;QACF,UAAU;QACV,QAAQ;IACV;IACA,IAAI;QACF,UAAU;QACV,QAAQ;IACV;IACA,IAAI;QACF,UAAU;QACV,QAAQ;IACV;AACF;AAEO,SAAS;IACd,MAAM,SAAS;IACf,MAAM,UAAU;IAChB,IAAI,WAAW;IAEf,sDAAsD;IACtD,MAAM,QAAQ,QAAQ,KAAK,CAAC,UAAU,GAAG,MAAM;IAC/C,MAAM,QAAQ,QAAQ,KAAK,CAAC,UAAU,GAAG,MAAM;IAC/C,MAAM,SAAS,QAAQ,KAAK,CAAC,UAAU,GAAG,MAAM;IAChD,MAAM,SAAS,QAAQ,KAAK,CAAC,eAAe,GAAG,MAAM;IAErD,YAAY,QAAQ,QAAQ,SAAS;IAErC,yBAAyB;IACzB,IAAK,IAAI,IAAI,SAAS,MAAM,EAAE,IAAI,QAAQ,IAAK;QAC7C,YAAY,QAAQ,MAAM,CAAC,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ,MAAM;IACtE;IAEA,uBAAuB;IACvB,OAAO,SAAS,KAAK,CAAC,IAAI,IAAI,CAAC,IAAM,KAAK,MAAM,KAAK,KAAK,IAAI,CAAC;AACjE","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/data/users.json"],"sourcesContent":["{\"users\":[{\"id\":\"admin\",\"username\":\"binbin\",\"passwordHash\":\"$2a$12$K7L/OJSkXrdDJ720SayTguKPyDmVNL3/NHrBSaGSYhUeWrrUvt4lm\"}]}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 104, "column": 150}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/app/api/auth/reset/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { securityQuestions, generatePassword, hashPassword } from '@/lib/auth';\nimport users from '@/data/users.json';\nimport { promises as fs } from 'fs';\nimport path from 'path';\n\nexport async function POST(request: Request) {\n  const { answers } = await request.json();\n\n  // Verify all answers\n  for (const [key, { answer }] of Object.entries(securityQuestions)) {\n    if (answers[key]?.toLowerCase() !== answer.toLowerCase()) {\n      return NextResponse.json(\n        { error: 'Invalid answers' },\n        { status: 401 }\n      );\n    }\n  }\n\n  // Generate new password\n  const newPassword = generatePassword();\n  const hashedPassword = await hashPassword(newPassword);\n\n  // Update user password\n  const updatedUsers = {\n    users: users.users.map(user => ({\n      ...user,\n      passwordHash: hashedPassword\n    }))\n  };\n\n  // Save to file\n  const usersPath = path.join(process.cwd(), 'src/data/users.json');\n  await fs.writeFile(usersPath, JSON.stringify(updatedUsers, null, 2));\n\n  return NextResponse.json({ newPassword }, { status: 200 });\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,eAAe,KAAK,OAAgB;IACzC,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,QAAQ,IAAI;IAEtC,qBAAqB;IACrB,KAAK,MAAM,CAAC,KAAK,EAAE,MAAM,EAAE,CAAC,IAAI,OAAO,OAAO,CAAC,yIAAiB,EAAG;QACjE,IAAI,OAAO,CAAC,IAAI,EAAE,kBAAkB,OAAO,WAAW,IAAI;YACxD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkB,GAC3B;gBAAE,QAAQ;YAAI;QAElB;IACF;IAEA,wBAAwB;IACxB,MAAM,cAAc,IAAA,wIAAgB;IACpC,MAAM,iBAAiB,MAAM,IAAA,oIAAY,EAAC;IAE1C,uBAAuB;IACvB,MAAM,eAAe;QACnB,OAAO,uGAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA,OAAQ,CAAC;gBAC9B,GAAG,IAAI;gBACP,cAAc;YAChB,CAAC;IACH;IAEA,eAAe;IACf,MAAM,YAAY,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;IAC3C,MAAM,yGAAE,CAAC,SAAS,CAAC,WAAW,KAAK,SAAS,CAAC,cAAc,MAAM;IAEjE,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE;IAAY,GAAG;QAAE,QAAQ;IAAI;AAC1D","debugId":null}}]
}