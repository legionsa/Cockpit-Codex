{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/lib/blocks.ts"],"sourcesContent":["export type BlockType =\n  | 'heading'\n  | 'paragraph'\n  | 'image'\n  | 'video'\n  | 'figmaEmbed'\n  | 'code'\n  | 'tokenTable'\n  | 'alert'\n  | 'list'\n  | 'quote'\n  | 'childPagesGrid'\n  | 'button'\n  | 'divider'\n  | 'spacer';\n\nexport interface BaseBlock {\n  id: string;\n}\n\nexport interface HeadingBlock extends BaseBlock {\n  type: 'heading';\n  level: 1 | 2 | 3;\n  content: string;\n}\n\nexport interface ParagraphBlock extends BaseBlock {\n  type: 'paragraph';\n  content: string;\n}\n\nexport interface ImageBlock extends BaseBlock {\n  type: 'image';\n  src: string;\n  caption?: string;\n  alt?: string;\n  align?: 'left' | 'center' | 'right';\n}\n\nexport interface VideoBlock extends BaseBlock {\n  type: 'video';\n  url: string;\n  caption?: string;\n}\n\nexport interface FigmaEmbedBlock extends BaseBlock {\n  type: 'figmaEmbed';\n  url: string;\n  height?: number | string;\n}\n\nexport interface CodeBlock extends BaseBlock {\n  type: 'code';\n  language: string;\n  content: string;\n}\n\nexport interface TokenTableBlock extends BaseBlock {\n  type: 'tokenTable';\n  tokenGroup: string;\n  description?: string;\n}\n\nexport interface AlertBlock extends BaseBlock {\n  type: 'alert';\n  variant: 'info' | 'warning' | 'success' | 'danger';\n  content: string;\n}\n\nexport interface ListBlock extends BaseBlock {\n  type: 'list';\n  ordered?: boolean;\n  items: string[];\n}\n\nexport interface QuoteBlock extends BaseBlock {\n  type: 'quote';\n  content: string;\n  author?: string;\n}\n\nexport interface ChildPagesGridBlock extends BaseBlock {\n  type: 'childPagesGrid';\n  childIds: string[];\n  layout?: '1col' | '2col' | '3col';\n}\n\nexport interface ButtonBlock extends BaseBlock {\n  type: 'button';\n  label: string;\n  url: string;\n  variant?: 'primary' | 'secondary' | 'link';\n}\n\nexport interface DividerBlock extends BaseBlock {\n  type: 'divider';\n  size?: 'sm' | 'md' | 'lg';\n}\n\nexport interface SpacerBlock extends BaseBlock {\n  type: 'spacer';\n  size?: number | string;\n}\n\nexport type Block =\n  | HeadingBlock\n  | ParagraphBlock\n  | ImageBlock\n  | VideoBlock\n  | FigmaEmbedBlock\n  | CodeBlock\n  | TokenTableBlock\n  | AlertBlock\n  | ListBlock\n  | QuoteBlock\n  | ChildPagesGridBlock\n  | ButtonBlock\n  | DividerBlock\n  | SpacerBlock;\n\nexport function validateBlock(block: unknown): block is Block {\n  if (!block || typeof block !== 'object') return false;\n  const b = block as any;\n  if (typeof b.type !== 'string' || typeof b.id !== 'string') return false;\n\n  switch (b.type) {\n    case 'heading':\n      return (b.level === 1 || b.level === 2 || b.level === 3) && typeof b.content === 'string';\n    case 'paragraph':\n      return typeof b.content === 'string';\n    case 'image':\n      return typeof b.src === 'string';\n    case 'video':\n      return typeof b.url === 'string';\n    case 'figmaEmbed':\n      return typeof b.url === 'string';\n    case 'code':\n      return typeof b.language === 'string' && typeof b.content === 'string';\n    case 'tokenTable':\n      return typeof b.tokenGroup === 'string';\n    case 'alert':\n      return ['info', 'warning', 'success', 'danger'].includes(b.variant) && typeof b.content === 'string';\n    case 'list':\n      return Array.isArray(b.items) && b.items.every((i: any) => typeof i === 'string');\n    case 'quote':\n      return typeof b.content === 'string';\n    case 'childPagesGrid':\n      return Array.isArray(b.childIds) && b.childIds.every((i: any) => typeof i === 'string');\n    case 'button':\n      return typeof b.label === 'string' && typeof b.url === 'string';\n    case 'divider':\n      return true;\n    case 'spacer':\n      return true;\n    default:\n      return false;\n  }\n}\n"],"names":[],"mappings":";;;;AAwHO,SAAS,cAAc,KAAc;IAC1C,IAAI,CAAC,SAAS,OAAO,UAAU,UAAU,OAAO;IAChD,MAAM,IAAI;IACV,IAAI,OAAO,EAAE,IAAI,KAAK,YAAY,OAAO,EAAE,EAAE,KAAK,UAAU,OAAO;IAEnE,OAAQ,EAAE,IAAI;QACZ,KAAK;YACH,OAAO,CAAC,EAAE,KAAK,KAAK,KAAK,EAAE,KAAK,KAAK,KAAK,EAAE,KAAK,KAAK,CAAC,KAAK,OAAO,EAAE,OAAO,KAAK;QACnF,KAAK;YACH,OAAO,OAAO,EAAE,OAAO,KAAK;QAC9B,KAAK;YACH,OAAO,OAAO,EAAE,GAAG,KAAK;QAC1B,KAAK;YACH,OAAO,OAAO,EAAE,GAAG,KAAK;QAC1B,KAAK;YACH,OAAO,OAAO,EAAE,GAAG,KAAK;QAC1B,KAAK;YACH,OAAO,OAAO,EAAE,QAAQ,KAAK,YAAY,OAAO,EAAE,OAAO,KAAK;QAChE,KAAK;YACH,OAAO,OAAO,EAAE,UAAU,KAAK;QACjC,KAAK;YACH,OAAO;gBAAC;gBAAQ;gBAAW;gBAAW;aAAS,CAAC,QAAQ,CAAC,EAAE,OAAO,KAAK,OAAO,EAAE,OAAO,KAAK;QAC9F,KAAK;YACH,OAAO,MAAM,OAAO,CAAC,EAAE,KAAK,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,IAAW,OAAO,MAAM;QAC1E,KAAK;YACH,OAAO,OAAO,EAAE,OAAO,KAAK;QAC9B,KAAK;YACH,OAAO,MAAM,OAAO,CAAC,EAAE,QAAQ,KAAK,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAW,OAAO,MAAM;QAChF,KAAK;YACH,OAAO,OAAO,EAAE,KAAK,KAAK,YAAY,OAAO,EAAE,GAAG,KAAK;QACzD,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF","debugId":null}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/lib/pages.ts"],"sourcesContent":["import type { Block } from './blocks';\nimport { validateBlock } from './blocks';\n\nexport interface Page {\n  id: string;\n  title: string;\n  slug: string;\n  parentId: string | null;\n  order: number;\n  summary?: string;\n  // legacy markdown fields kept for compatibility\n  contentType?: 'markdown';\n  content?: string;\n  // blocks-based content (preferred)\n  blocks?: Block[];\n  figmaEmbedUrl?: string;\n  codeSnippets?: {\n    react?: string;\n    tailwind?: string;\n    tokensJson?: string;\n  };\n  tags?: string[];\n  status: 'Draft' | 'Published' | 'Archived';\n  version?: string;\n  lastUpdated: string;\n  children?: Page[];\n}\n\n  export function validatePage(page: unknown): page is Page {\n    if (!page || typeof page !== 'object') return false;\n\n    const p = page as Partial<Page>;\n  \n    // Required fields (lean validation)\n    if (\n      typeof p.id !== 'string' ||\n      typeof p.title !== 'string' ||\n      typeof p.slug !== 'string' ||\n      typeof p.order !== 'number' ||\n      typeof p.lastUpdated !== 'string' ||\n      !['Draft', 'Published', 'Archived'].includes(p.status || '')\n    ) {\n      return false;\n    }\n\n    // Optional fields\n    if (\n      (p.parentId !== undefined && p.parentId !== null && typeof p.parentId !== 'string') ||\n      (p.summary !== undefined && typeof p.summary !== 'string') ||\n      (p.figmaEmbedUrl !== undefined && typeof p.figmaEmbedUrl !== 'string') ||\n      (p.version !== undefined && typeof p.version !== 'string') ||\n      (p.tags !== undefined && (!Array.isArray(p.tags) || !p.tags.every(tag => typeof tag === 'string')))\n    ) {\n      return false;\n    }\n\n    // Code snippets validation\n    if (p.codeSnippets !== undefined) {\n      const snippets = p.codeSnippets as Record<string, unknown>;\n      if (\n        typeof snippets !== 'object' ||\n        (snippets.react !== undefined && typeof snippets.react !== 'string') ||\n        (snippets.tailwind !== undefined && typeof snippets.tailwind !== 'string') ||\n        (snippets.tokensJson !== undefined && typeof snippets.tokensJson !== 'string')\n      ) {\n        return false;\n      }\n    }\n\n    // Blocks validation (if present)\n    if (p.blocks !== undefined) {\n      if (!Array.isArray(p.blocks)) return false;\n      for (const b of p.blocks) {\n        if (!validateBlock(b)) return false;\n      }\n    }\n\n    return true;\n  }\n\nexport function generateSlug(title: string): string {\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-|-$/g, '');\n}\n\nexport function buildBreadcrumbs(pages: Page[], currentPageId: string): Array<{ title: string; href: string }> {\n  const breadcrumbs: Array<{ title: string; href: string }> = [];\n  let currentPage = pages.find(p => p.id === currentPageId);\n  \n  while (currentPage) {\n    breadcrumbs.unshift({\n      title: currentPage.title,\n      href: `/${currentPage.slug}`\n    });\n    \n    const parentId = currentPage.parentId;\n    if (parentId) {\n      const parentPage = pages.find(p => p.id === parentId);\n      if (!parentPage) break;\n      currentPage = parentPage;\n    } else {\n      break;\n    }\n  }\n  \n  return breadcrumbs;\n}\n\nexport function buildPageTree(pages: Page[]): Page[] {\n  const pageMap = new Map(pages.map(page => [page.id, { ...page, children: [] as Page[] }]));\n  const tree: Page[] = [];\n  \n  pages.forEach(page => {\n    if (page.parentId) {\n      const parent = pageMap.get(page.parentId);\n      const currentPage = pageMap.get(page.id);\n      if (parent && currentPage) {\n        parent.children = parent.children || [];\n        parent.children.push(currentPage);\n      }\n    } else {\n      const rootPage = pageMap.get(page.id);\n      if (rootPage) {\n        tree.push(rootPage);\n      }\n    }\n  });\n  \n  return tree;\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 203, "column": 0}, "map": {"version":3,"sources":["file:///Users/lion/Documents/%5B01%5D%20Projects/Cockpit%20Codex/src/app/api/pages/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { promises as fs } from 'fs';\nimport path from 'path';\nimport { generateSlug } from '@/lib/pages';\nimport type { Page } from '@/lib/pages';\n\nconst pagesDir = path.join(process.cwd(), 'src/data/pages');\nconst redirectsPath = path.join(process.cwd(), 'src/data/redirects.json');\n\n// GET /api/pages - List all pages\nexport async function GET() {\n  const files = await fs.readdir(pagesDir);\n  const pages = await Promise.all(\n    files.map(async (file) => {\n      const content = await fs.readFile(path.join(pagesDir, file), 'utf8');\n      return JSON.parse(content);\n    })\n  );\n  \n  return NextResponse.json(pages);\n}\n\n// POST /api/pages - Create new page\nexport async function POST(request: Request) {\n  const data = await request.json();\n  const { title, parentId } = data;\n  \n  if (!title) {\n    return NextResponse.json(\n      { error: 'Title is required' },\n      { status: 400 }\n    );\n  }\n\n  const slug = generateSlug(title);\n  const id = parentId ? `${parentId}-${slug}` : slug;\n  \n  // Check for existing page with same slug under same parent\n  try {\n    await fs.access(path.join(pagesDir, `${id}.json`));\n    return NextResponse.json(\n      { error: 'Page with this slug already exists under the selected parent' },\n      { status: 409 }\n    );\n  } catch {\n    // File doesn't exist, we can proceed\n  }\n\n  const page: Page = {\n    id,\n    title,\n    slug,\n    parentId,\n    order: Date.now(), // Temporary order, should be managed properly\n    contentType: 'markdown',\n    content: '',\n    status: 'Draft',\n    lastUpdated: new Date().toISOString(),\n    ...data\n  };\n\n  await fs.writeFile(\n    path.join(pagesDir, `${id}.json`),\n    JSON.stringify(page, null, 2)\n  );\n\n  return NextResponse.json(page);\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;;;;AAGA,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAC1C,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;AAGxC,eAAe;IACpB,MAAM,QAAQ,MAAM,yGAAE,CAAC,OAAO,CAAC;IAC/B,MAAM,QAAQ,MAAM,QAAQ,GAAG,CAC7B,MAAM,GAAG,CAAC,OAAO;QACf,MAAM,UAAU,MAAM,yGAAE,CAAC,QAAQ,CAAC,4GAAI,CAAC,IAAI,CAAC,UAAU,OAAO;QAC7D,OAAO,KAAK,KAAK,CAAC;IACpB;IAGF,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAGO,eAAe,KAAK,OAAgB;IACzC,MAAM,OAAO,MAAM,QAAQ,IAAI;IAC/B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;IAE5B,IAAI,CAAC,OAAO;QACV,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAoB,GAC7B;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,OAAO,IAAA,qIAAY,EAAC;IAC1B,MAAM,KAAK,WAAW,GAAG,SAAS,CAAC,EAAE,MAAM,GAAG;IAE9C,2DAA2D;IAC3D,IAAI;QACF,MAAM,yGAAE,CAAC,MAAM,CAAC,4GAAI,CAAC,IAAI,CAAC,UAAU,GAAG,GAAG,KAAK,CAAC;QAChD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+D,GACxE;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAM;IACN,qCAAqC;IACvC;IAEA,MAAM,OAAa;QACjB;QACA;QACA;QACA;QACA,OAAO,KAAK,GAAG;QACf,aAAa;QACb,SAAS;QACT,QAAQ;QACR,aAAa,IAAI,OAAO,WAAW;QACnC,GAAG,IAAI;IACT;IAEA,MAAM,yGAAE,CAAC,SAAS,CAChB,4GAAI,CAAC,IAAI,CAAC,UAAU,GAAG,GAAG,KAAK,CAAC,GAChC,KAAK,SAAS,CAAC,MAAM,MAAM;IAG7B,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B","debugId":null}}]
}